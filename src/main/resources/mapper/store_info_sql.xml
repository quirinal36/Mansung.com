<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="store_info_sql">
	<insert id="insert" useGeneratedKeys="true" keyProperty="id" parameterType="store">
		INSERT INTO StoreInfo
		(
			title, 
			address1, 
			address2, 
			address3, 
			address4, 
			address5,
			address6,  
			postcode, 
			xPosition, 
			yPosition, 
			phone1, 
			phone2, 
			information, 
			website,
			blog,
			time,
			representImage,
			category
		)
		VALUES
		(
			'${title}', 
			'${address1}', 
			'${address2}', 
			'${address3}', 
			'${address4}', 
			'${address5}',
			'${address6}',  
			'${postcode}',
			'${xPosition}',
			'${yPosition}', 
			'${phone1}',
			'${phone2}',
			'${information}', 
			'${website}',
			'${blog}',
			'${time}',
			${representImage},
			${category}
		)
	</insert>
	<select id="select" parameterType="store" resultType="store">
		SELECT 
			s.*, 
			c.title AS categoryTitle
		FROM 
			StoreInfo s LEFT JOIN Category c 
			ON
			s.category = c.id
		<if test="category > 0">
			<where>
				s.category = ${category}
			</where>
		</if>
	</select>
	<select id="select_all" resultType="store">
		SELECT 
			s.*, 
			c.title AS categoryTitle
		FROM 
			StoreInfo s LEFT JOIN Category c 
			ON
			s.category = c.id
	</select>
	
	<select id="count" parameterType="store" resultType="int">
		SELECT COUNT(*)
		FROM StoreInfo
		<if test="category > 0">
			<where>		
				category = ${category}
			</where>
		</if>
	</select>
	
	<select id="select_one" resultType="store" parameterType="store">
		SELECT 
			s.*, 
			c.title AS categoryTitle
		FROM 
			StoreInfo s LEFT JOIN Category c 
			ON
			s.category = c.id
		<where>
			s.id = ${id}
		</where>
	</select>
	
	<update id="update" parameterType="store">
		UPDATE StoreInfo
		<set>
			title='${title}', 
			address1 = '${address1}', 
			address2 = '${address2}', 
			address3 = '${address3}', 
			address4 = '${address4}', 
			address5 = '${address5}',
			address6 = '${address6}', 
			postcode = '${postcode}',
			xPosition = '${xPosition}', 
			yPosition = '${yPosition}', 
			phone1 = '${phone1}',
			phone2 = '${phone2}',
			information = '${information}', 
			website = '${website}',
			blog = '${blog}',
			time = '${time}',
			representImage = ${representImage},
			category = ${category}
		</set>
		<where>
			id=${id}
		</where>
	</update>
</mapper>